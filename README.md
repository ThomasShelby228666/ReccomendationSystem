# Movie Recommendation System (Система Рекомендаций Фильмов)

## Обзор проекта

Данный проект представляет собой систему рекомендаций фильмов, которая использует **векторный поиск** для нахождения семантически похожих фильмов на основе текстового запроса пользователя, а также **автоматическую классификацию текста** (жанр и эмоциональный тон) для дополнительной фильтрации и сортировки результатов. Веб-интерфейс для взаимодействия с системой реализован с помощью библиотеки **Gradio**.

---

## Используемые Технологии

| Категория | Технология | Назначение                                                       |
| :--- | :--- |:-----------------------------------------------------------------|
| **Рекомендации** | **LangChain**, HuggingFaceEmbeddings, Chroma | Векторный поиск и хранение эмбеддингов описаний фильмов.         |
| **ML/NLP** | `j-hartmann/emotion-english-distilroberta-base` | Классификация эмоционального тона (Sentiment Analysis) описаний. |
| **ML/NLP** | `facebook/bart-large-mnli` (Zero-shot) | Автоматическая классификация фильмов по жанру.                   |
| **Интерфейс** | **Gradio** | Создание простого и быстрого веб-интерфейса (Dashboard).         |
| **Анализ данных** | **Pandas**, Matplotlib, Seaborn | Обработка данных и разведочный анализ данных (EDA).              |
| **Прочее** | `.env`, `requirements.txt` | Управление переменными окружения и зависимостями.                |

---

## Структура Проекта

RecommendationSystem/

├── .gradio/

├── .venv/                           # Виртуальное окружение

├── data/

│   ├── TMDB_movie_dataset_v11.csv   # Исходный датасет

│   ├── movies_cleaned.csv           # Датасет после EDA

│   ├── movies_with_genres.csv       # После классификации жанров

│   ├── movies_with_emotions.csv     # Итоговый датасет с эмоциональными оценками

│   └── tagged_overview.txt          # Файл для создания эмбеддингов (imdb_id + overview)

├── imgs/

│   └── not_found.png                # Заглушка для постеров

├── src/                             # Рабочие Jupyter-ноутбуки и переменные окружения

│   ├── .env

│   ├── EDA.ipynb                    # Разведочный анализ данных

│   ├── sentiment_analysis.ipynb     # Анализ эмоционального тона

│   ├── text_classification.ipynb    # Классификация жанров (Zero-shot)

│   └── vector_search.ipynb          # Создание векторной базы данных

├── .gitignore                       # Файлы, исключаемые из системы контроля версий

├── dashboard.py                     # Основной файл приложения Gradio (Система рекомендаций)

└── requirements.txt                 # Список зависимостей Python

---

## Основные шаги обработки данных

1.  **`EDA.ipynb`**:
    * Загрузка исходного датасета.
    * Проверка пропущенных значений и корреляций.
    * Очистка данных (фильтрация по длине описания и количеству голосов).
    * Создание столбца `tagged_overview` (объединение `imdb_id` и `overview`) для векторного поиска.
    * Сохранение: `movies_cleaned.csv`.
2.  **`text_classification.ipynb`**:
    * Упрощение и балансировка жанров.
    * Использование Zero-shot классификатора (`facebook/bart-large-mnli`) для автоматического определения жанров.
    * Оценка качества классификации и заполнение пропущенных жанров.
    * Сохранение: `movies_with_genres.csv`.
3.  **`sentiment_analysis.ipynb`**:
    * Использование модели для анализа эмоций (`j-hartmann/emotion-english-distilroberta-base`) для каждого предложения в описании фильма.
    * Вычисление максимальной вероятности для каждой эмоции (`joy`, `anger`, `fear`, `sadness`, `surprise`, `neutral`) для каждого фильма.
    * Сохранение: `movies_with_emotions.csv` (используется в дашборде).
4.  **`vector_search.ipynb`**:
    * Подготовка текстового файла `tagged_overview.txt`.
    * Использование `HuggingFaceEmbeddings` (`sentence-transformers/all-MiniLM-L6-v2`) для создания векторных представлений.
    * Создание и сохранение векторной базы данных с помощью **ChromaDB**.

---

##  Запуск веб-приложения

### Предварительные условия

* Python 3.10+
* Наличие всех файлов данных в папке `data/` (они генерируются при последовательном запуске Jupyter-ноутбуков).

### Скачивание проекта (клонирование репозитория)

Для получения локальной копии проекта используйте команду `git clone`. Замените `<ссылка_на_репозиторий>` на фактическую ссылку, где размещён ваш проект.

```bash
git clone <ссылка_на_репозиторий>
cd RecommendationSystem/
```

### Установка зависимостей

1.  Создайте и активируйте виртуальное окружение:
    ```bash
    python -m venv .venv
    source .venv/bin/activate  # macOS/Linux
    .venv\Scripts\activate     # Windows
    ```
2.  Установите необходимые библиотеки из `requirements.txt`:
    ```bash
    pip install -r requirements.txt
    ```
3. Скачайте датасет по ссылке:
https://www.kaggle.com/datasets/asaniczka/tmdb-movies-dataset-2023-930k-movies

### Запуск дашборда

После активации окружения, запуска блокнотов и установки зависимостей запустите основной файл:

```bash
python dashboard.py
```
Приложение будет доступно по адресу http://127.0.0.1:7860